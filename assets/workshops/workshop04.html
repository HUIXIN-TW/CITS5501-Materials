<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title> CITS5501 Software Testing and Quality Assurance  Semester 1, 2022  Workshop 4 (week 5) – graphs </title>
  <style>
    html {
      line-height: 1.5;
      font-family: sans serif;
      font-size: 12pt;
      color: black;
      background-color: white;
    }
    body {
      margin: 0 auto;
      max-width: 50em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      background-color: hsl(0, 0%, 98%);
      padding: .2em .4em;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      background-color: hsl(0, 0%, 98%);
      padding: 1em;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    /* Inline code */
    :not(pre) > code {
      padding: 2px 4px;
      font-size: 90%;
      word-break: normal !important;
      white-space: nowrap;
      color: hsl(344.8,69%,10%);
      background-color: hsl(342.9,37%,96%);
      border-radius: 4px;
    }
    .sourceCode {
     background-color: hsl(0, 0%, 98%);
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid black;
      border-bottom: 1px solid black;
    }
    th {
      border-top: 1px solid black;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style>
    div.solutions {
      border: solid 2pt hsla(120, 100%, 35%, 1);
      border-radius: 5pt;
      background-color: hsla(120, 100%, 50%, 0.1);
      padding: 1em;
    }
  </style>
<script data-external="1" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript">
</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title"><p> CITS5501 Software Testing and Quality Assurance
Semester 1, 2022 Workshop 4 (week 5) – graphs </p></h1>
</header>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#isp-graphs-and-control-flow">1. ISP, graphs and control
flow</a></li>
<li><a href="#test-fixtures">2. Test fixtures</a></li>
</ul>
</nav>
<h2 id="isp-graphs-and-control-flow">1. ISP, graphs and control
flow</h2>
<p>Consider the following Java method for collapsing sequences of
blanks, taken from the <code>StringUtils</code> class of Apache Velocity
(<a href="http://velocity.apache.org/" class="uri">http://velocity.apache.org/</a>), version 1.3.1:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource java numberLines"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1"></a></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">/**</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">*</span> Remove<span class="co">/</span>collapse multiple spaces<span class="co">.</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">*</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">*</span> <span class="co">@</span>param String string to remove multiple spaces from<span class="co">.</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">*</span> <span class="co">@</span>return String</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">*/</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">collapseSpaces</span><span class="op">(</span><span class="bu">String</span> argStr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="dt">char</span> last <span class="op">=</span> argStr<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="bu">StringBuffer</span> argBuf <span class="op">=</span> <span class="kw">new</span> <span class="bu">StringBuffer</span><span class="op">();</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> cIdx <span class="op">=</span> <span class="dv">0</span> <span class="op">;</span> cIdx <span class="op">&lt;</span> argStr<span class="op">.</span><span class="fu">length</span><span class="op">();</span> cIdx<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="dt">char</span> ch <span class="op">=</span> argStr<span class="op">.</span><span class="fu">charAt</span><span class="op">(</span>cIdx<span class="op">);</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="cf">if</span> <span class="op">(</span>ch <span class="op">!=</span> <span class="ch">&#39; &#39;</span> <span class="op">||</span> last <span class="op">!=</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>      argBuf<span class="op">.</span><span class="fu">append</span><span class="op">(</span>ch<span class="op">);</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>      last <span class="op">=</span> ch<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="op">}</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="op">}</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="cf">return</span> argBuf<span class="op">.</span><span class="fu">toString</span><span class="op">();</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="op">}</span></span></code></pre></div>
<ol type="a">
<li><p>Using the ISP principles we have covered in class, suggest some
<em>characteristics</em> we could use to partition the
<code>argStr</code> parameter.</p>
<p>Once you have several characteristics, consider how you might choose
combinations of partitions from them. A recommended approach is to aim
for “Base Choice” coverage:</p>
<ol type="i">
<li>For each characteristic, pick a “base choice” (and explain the
reasoning behind that choice)</li>
<li>Select test values for a “base choice” test.</li>
<li>Go through and derive test values for the “non-base”
partitions.</li>
</ol>
<p>Try writing JUnit tests for some of your test values. Compare the
characteristics and test values you derived with those of someone else
in the same lab. Are your solutions the same?</p></li>
<li><p>Using the techniques outlined in the last lecture, try to
construct a <em>control flow graph</em> of the method.</p>
<p>How many nodes do you end up with?<br />
How many edges?</p></li>
</ol>
<p>You may wish to work with a partner for these exercises, and compare
your answers.</p>
<p>For the purposes of this exercise, we’ll take a simplified approach:
you may ignore calls to other methods, such as <code>.charAt()</code>,
and need only model the control flow <em>within</em> the method. (What
about possible exceptions? Should they be modelled, or not? Why?)</p>
<p>A typical way of “labelling” your graph nodes needs is to use letters
(“A”, “B”, “C” and so on), and to provide a legend, showing a reader
which nodes correspond to which lines (or fragments of lines) of
code.</p>
<p>Sometimes there may be multiple nodes representing fragments of code
all within the same line (e.g. line 11). As long as you have a clear
explanation of what each node represents (e.g. “node D: the line 11 loop
condition”) then that’s fine.</p>
<ol start="3" type="a">
<li><p>Given your test cases from part (a), try mentally or on paper
“executing” several tests, and see what paths of the graph get exercised
by each of your tests.</p>
<p>How would you subjectively rate the “coverage” of the graph by your
tests – good? reasonable? poor?</p></li>
<li><p>Work out whether your tests give the following sorts of
coverage:</p>
<ol type="i">
<li>node coverage</li>
<li>edge coverage</li>
</ol></li>
<li><p>What are the <em>prime paths</em> in your graph? What proportion
of the prime paths are exercised by the tests you’ve given?</p>
<p>Can you construct some tests which exercise prime paths you haven’t
already covered?</p></li>
</ol>
<h2 id="test-fixtures">2. Test fixtures</h2>
<p>Review the material from the textbook on test automation (ch 6), and
the JUnit 4 “Text fixtures” documentation (at <a href="https://github.com/junit-team/junit4/wiki/Test-fixtures" class="uri">https://github.com/junit-team/junit4/wiki/Test-fixtures</a>).</p>
<p>Consider the following code we wish to test:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyClass <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>   <span class="kw">private</span> <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>   <span class="kw">public</span> <span class="fu">MyClass</span><span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="kw">this</span><span class="op">.</span><span class="fu">x</span> <span class="op">=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">@Override</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>   <span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">equals</span><span class="op">(</span><span class="bu">Object</span> obj<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(!(</span>obj <span class="kw">instanceof</span> MyClass<span class="op">))</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="op">((</span>MyClass<span class="op">)</span> obj<span class="op">).</span><span class="fu">x</span> <span class="op">==</span> <span class="kw">this</span><span class="op">.</span><span class="fu">x</span><span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Find the Java library documentation for the <code>equals()</code>
method (it’s in the <code>Object</code> class), and read what its
requirements are.</p>
<p>In Java, all other classes automatically inherit from the
<code>Object</code> class, and may also <em>override</em> methods
provided by the <code>Object</code> class – this is what the
“<code>@Override</code>” annotation on the <code>equals()</code> method
means.</p>
<p>The <code>equals()</code> method should test whether the
<code>Object</code> “<code>obj</code>” is “equal to” the receiver
object, <code>this</code>, where what “equal to” means is decided on by
the implementer of the class. (The <code>equals()</code> method in Java
serves the same purpose as the <code>__eq__</code> special method in
Python.) The implementer is free to decide for themselves what “equal
to” means for their class.</p>
<p>In order to avoid suprising behaviour for callers of the method, in
general equality should be an <a href="https://en.wikipedia.org/wiki/Equivalence_relation"><em>equivalence
relation</em></a>; for instance, an object should always be equal to
itself, and if <code>a.equals(b)</code> is true and
<code>b.equals(c)</code> is true, then <code>a.equals(c)</code> should
also be true.</p>
<p>The <code>instanceof</code> keyword in Java allows us to check
whether an object is an instace of some class (or some class that
inherits from that class, directly or indirectly). Normally,
implementers of <code>equals</code> will want to return
“<code>false</code>” whenever we try to compare with objects not of the
same class.</p>
<p>Create a new Java project, create a <code>MyClass.java</code> file
containing the code above, and check that it compiles.</p>
<p><strong>A test class</strong></p>
<p>Suppose we use the following test code for our <code>MyClass</code>
class:</p>
<pre><code>import static org.junit.jupiter.api.Assertions.*;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class MyClassTest {
   private MyClass mc1;
   private MyClass mc2;
   private MyClass mc3;

   @BeforeEach
   public void setUp() {
     mc1 = new MyClass(3);
     mc2 = new MyClass(5);
     mc3 = new MyClass(3);
   }

   @Test
   /* Test the case when, for two objects, the second is null */
   public void equalsWhenNullRef() { fail(&quot;incomplete&quot;); }

   @Test
   /* Test the case when, for two objects, they are not equal */
   public void equalsWhenNotEq() {/*...*/}

   @Test
   /* Test the case when, for two objects, they are equall */
   public void equalsWhenEq() {/*...*/}

}</code></pre>
<p>In this case, the instance variables <code>mc1</code>,
<code>mc2</code> and <code>mc3</code> are potential <em>fixtures</em>
for any test.</p>
<ol type="1">
<li><p>Given the test code above, how many times will the
<code>setUp()</code> method execute?</p>
<p>Compile and run the tests and check whether this is the
case.</p></li>
<li><p>It is good practice, when writing new tests, to ensure that at
first they <em>fail</em>. This is useful as a warning, so that you know
the test is not yet complete. (We don’t want to accidentally give our
code to other developers when it contains tests that are incomplete, or
do the wrong thing.)</p>
<p>Insert code into the test methods that will always fail. What JUnit
method have you used? Are there any other ways you can think of (or spot
in the JUnit documentation) for writing a test that always
fails?</p></li>
<li><p>Fill in code for the test methods in this class.</p></li>
<li><p>Are there any other tests you think we should add in order to
thoroughly test our class? What are they?</p></li>
<li><p>Using the material from lectures, and the JUnit user guide, write
a “teardown” method. What code should go in it? Is it necessary in this
case? Why or why not?</p></li>
</ol>
<!-- vim: syntax=markdown tw=72 :
-->
</body>
</html>
